<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üìä Statistiques ML - Tennis Predictions</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            min-height: 100vh;
            padding: 20px 0;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }
        .header {
            text-align: center;
            margin-bottom: 40px;
            padding: 30px 0;
            position: relative;
        }
        .header h1 {
            font-size: 3rem;
            font-weight: 800;
            margin-bottom: 15px;
            background: linear-gradient(45deg, #ffffff, #e0e7ff);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            letter-spacing: -0.5px;
        }
        .header p {
            margin: 15px 0 0 0;
            opacity: 0.9;
            font-size: 1.2rem;
            font-weight: 500;
        }
        .back-button {
            position: absolute;
            left: 0;
            top: 50%;
            transform: translateY(-50%);
            background: rgba(255, 255, 255, 0.2);
            border: 2px solid rgba(255, 255, 255, 0.3);
            color: white;
            padding: 12px 20px;
            border-radius: 25px;
            text-decoration: none;
            font-weight: 600;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        .back-button:hover {
            background: rgba(255, 255, 255, 0.3);
            border-color: rgba(255, 255, 255, 0.5);
            transform: translateY(-50%) translateX(-5px);
            color: white;
        }
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin-bottom: 30px;
            max-width: 400px;
            margin-left: auto;
            margin-right: auto;
        }
        .stat-card {
            background: white;
            padding: 20px 15px;
            border-radius: 12px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            text-align: center;
            transition: transform 0.3s ease;
        }
        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.2);
        }
        .stat-number {
            font-size: 2.5rem;
            font-weight: 800;
            color: #3b82f6;
            margin-bottom: 8px;
        }
        .stat-card div:last-child {
            color: #6b7280;
            font-weight: 600;
            font-size: 0.9rem;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        .section {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 30px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        .section h3 {
            margin-bottom: 20px;
            font-size: 1.4rem;
            font-weight: 700;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        .performance-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }
        .performance-card {
            background: rgba(255, 255, 255, 0.9);
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .performance-number {
            font-size: 2rem;
            font-weight: bold;
            margin-bottom: 5px;
        }
        .performance-label {
            color: #6b7280;
            font-size: 0.9rem;
            font-weight: 600;
        }
        .tournament-table {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 10px;
            overflow: hidden;
            margin-top: 15px;
        }
        .table-header {
            background: #3b82f6;
            color: white;
            padding: 15px;
            font-weight: 600;
            display: grid;
            grid-template-columns: 2fr 1fr 1fr 1fr 1fr;
            gap: 15px;
            align-items: center;
        }
        .table-row {
            padding: 12px 15px;
            display: grid;
            grid-template-columns: 2fr 1fr 1fr 1fr 1fr;
            gap: 15px;
            align-items: center;
            border-bottom: 1px solid #e5e7eb;
            color: #1f2937;
        }
        .table-row:hover {
            background: #f8fafc;
        }
        .success-rate {
            font-weight: bold;
            padding: 4px 8px;
            border-radius: 4px;
            text-align: center;
        }
        .rate-high { background: #d1fae5; color: #065f46; }
        .rate-medium { background: #fef3c7; color: #92400e; }
        .rate-low { background: #fee2e2; color: #991b1b; }
        .rate-pending { background: #f3f4f6; color: #6b7280; }
        
        @media (max-width: 768px) {
            .stats-grid {
                grid-template-columns: 1fr 1fr;
                gap: 15px;
            }
            .performance-grid {
                grid-template-columns: 1fr;
            }
            .table-header, .table-row {
                grid-template-columns: 1fr;
                gap: 8px;
                text-align: center;
            }
            .back-button {
                position: static;
                transform: none;
                margin-bottom: 20px;
                align-self: flex-start;
            }
            .header {
                display: flex;
                flex-direction: column;
                align-items: center;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <a href="index.html" class="back-button">
                ‚Üê Retour au Dashboard
            </a>
            <h1>üìä Statistiques ML</h1>
            <p>Analyse des performances du mod√®le de pr√©diction tennis</p>
        </div>

        <!-- Statistiques principales -->
        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-number" id="total-matches">24</div>
                <div>Pr√©dictions Totales</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="success-rate">66.7%</div>
                <div>Taux de R√©ussite</div>
            </div>
        </div>

        <!-- Performance du Mod√®le ML -->
        <div class="section">
            <h3>ü§ñ Performance du Mod√®le ML</h3>
            
            <!-- Sous-bloc: Pr√©dictions -->
            <div style="margin-bottom: 25px;">
                <h4 style="color: #3b82f6; margin-bottom: 15px; font-size: 1.1rem; font-weight: 600;">üìä Ensemble des Pr√©dictions</h4>
                <div class="performance-grid" style="grid-template-columns: repeat(2, 1fr);">
                    <div class="performance-card">
                        <div class="performance-number" style="color: #059669;" id="predictions-evaluated">6</div>
                        <div class="performance-label">Pr√©dictions √âvalu√©es</div>
                    </div>
                    <div class="performance-card">
                        <div class="performance-number" style="color: #dc2626;" id="predictions-pending">18</div>
                        <div class="performance-label">En Attente de R√©sultats</div>
                    </div>
                </div>
            </div>

            <!-- Sous-bloc: Entra√Ænement du Mod√®le -->
            <div>
                <h4 style="color: #7c3aed; margin-bottom: 15px; font-size: 1.1rem; font-weight: 600;">üß† Entra√Ænement du Mod√®le</h4>
                <div class="performance-grid" style="grid-template-columns: repeat(2, 1fr);">
                    <div class="performance-card">
                        <div class="performance-number" style="color: #7c3aed;" id="model-accuracy">67.4%</div>
                        <div class="performance-label">Pr√©cision Mod√®le ML</div>
                    </div>
                    <div class="performance-card">
                        <div class="performance-number" style="color: #0891b2;" id="training-data">58,481</div>
                        <div class="performance-label">Matchs d'Entra√Ænement</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Performance par Tournoi -->
        <div class="section">
            <h3>üèÜ Performance par Tournoi</h3>
            <div class="tournament-table">
                <div class="table-header">
                    <div>Tournoi</div>
                    <div>Total</div>
                    <div>√âvalu√©s</div>
                    <div>Corrects</div>
                    <div>Taux de R√©ussite</div>
                </div>
                <div id="tournament-stats">
                    <!-- Sera rempli dynamiquement -->
                </div>
            </div>
        </div>

        <!-- Pr√©dictions R√©centes -->
        <div class="section">
            <h3>üéæ Pr√©dictions R√©centes √âvalu√©es</h3>
            <div id="recent-predictions" style="margin-top: 15px;">
                <!-- Sera rempli dynamiquement -->
            </div>
        </div>
    </div>

    <script>
        // Variables globales
        let statsData = null;

        // Fonction pour r√©cup√©rer les statistiques depuis l'API
        async function fetchStats() {
            try {
                const response = await fetch('http://localhost:5001/api/stats');
                if (response.ok) {
                    const data = await response.json();
                    statsData = data;
                    updateStatsDisplay(data);
                } else {
                    console.warn('API stats non disponible, utilisation des donn√©es statiques');
                    updateStatsStatic();
                }
            } catch (error) {
                console.warn('Erreur API stats:', error.message);
                updateStatsStatic();
            }
        }

        function updateStatsDisplay(data) {
            const stats = data.global_stats;
            
            // Statistiques principales
            document.getElementById('total-matches').textContent = stats.total_predictions;
            document.getElementById('success-rate').textContent = stats.success_rate + '%';
            
            // Statistiques de performance
            document.getElementById('predictions-evaluated').textContent = stats.predictions_with_results;
            document.getElementById('predictions-pending').textContent = stats.total_predictions - stats.predictions_with_results;
            
            // Affichage des statistiques par tournoi
            displayTournamentStats(data.tournament_stats);
            
            // Affichage des pr√©dictions r√©centes
            displayRecentPredictions(data.recent_predictions);
        }

        function updateStatsStatic() {
            // Valeurs par d√©faut bas√©es sur les donn√©es actuelles
            document.getElementById('total-matches').textContent = '24';
            document.getElementById('success-rate').textContent = '66.7%';
            document.getElementById('predictions-evaluated').textContent = '6';
            document.getElementById('predictions-pending').textContent = '18';
            
            // Statistiques par tournoi statiques
            const staticTournamentStats = [
                { tournament: 'Sao Paulo WTA (WTA)', total: 4, with_results: 4, correct: 3, success_rate: 75.0 },
                { tournament: 'US Open ATP (ATP)', total: 1, with_results: 1, correct: 0, success_rate: 0.0 },
                { tournament: 'US Open WTA (WTA)', total: 1, with_results: 1, correct: 1, success_rate: 100.0 },
                { tournament: 'Guadalajara 2 WTA (WTA)', total: 18, with_results: 0, correct: 0, success_rate: null }
            ];
            displayTournamentStats(staticTournamentStats);
            
            // Pr√©dictions r√©centes statiques
            const staticRecentPredictions = [
                { match: 'Sinner vs Alcaraz', predicted: 'Sinner', actual: 'Alcaraz', correct: false, confidence: 69.5, date: '08/09/25' },
                { match: 'Sabalenka vs Anisimova', predicted: 'Sabalenka', actual: 'Sabalenka', correct: true, confidence: 69.5, date: '08/09/25' },
                { match: 'Pedretti vs Bosio', predicted: 'Pedretti', actual: 'Pedretti', correct: true, confidence: 72.7, date: '08/09/25' },
                { match: 'Herrero vs Grammatikopoulou', predicted: 'Grammatikopoulou', actual: 'Herrero Linana', correct: false, confidence: 57.6, date: '08/09/25' },
                { match: 'Rivoli vs Tona', predicted: 'Tona', actual: 'Tona', correct: true, confidence: 82.4, date: '08/09/25' },
                { match: 'Tran vs Zeballos', predicted: 'Tran', actual: 'Tran', correct: true, confidence: 68.4, date: '08/09/25' }
            ];
            displayRecentPredictions(staticRecentPredictions);
        }

        function displayTournamentStats(tournamentStats) {
            const container = document.getElementById('tournament-stats');
            container.innerHTML = '';
            
            tournamentStats.forEach(stat => {
                const successRateText = stat.success_rate !== null ? 
                    `${stat.success_rate.toFixed(1)}%` : 'En attente';
                
                const rateClass = stat.success_rate === null ? 'rate-pending' :
                    stat.success_rate >= 70 ? 'rate-high' :
                    stat.success_rate >= 50 ? 'rate-medium' : 'rate-low';
                
                const row = document.createElement('div');
                row.className = 'table-row';
                row.innerHTML = `
                    <div style="font-weight: 600;">${stat.tournament}</div>
                    <div style="text-align: center;">${stat.total}</div>
                    <div style="text-align: center;">${stat.with_results}</div>
                    <div style="text-align: center;">${stat.correct}</div>
                    <div style="text-align: center;">
                        <span class="success-rate ${rateClass}">${successRateText}</span>
                    </div>
                `;
                container.appendChild(row);
            });
        }

        function displayRecentPredictions(recentPredictions) {
            const container = document.getElementById('recent-predictions');
            container.innerHTML = '';
            
            recentPredictions.forEach(prediction => {
                const correctIcon = prediction.correct ? '‚úÖ' : '‚ùå';
                const correctClass = prediction.correct ? 'rate-high' : 'rate-low';
                
                const predictionCard = document.createElement('div');
                predictionCard.style.cssText = `
                    background: rgba(255, 255, 255, 0.9);
                    padding: 15px;
                    border-radius: 8px;
                    margin-bottom: 10px;
                    display: grid;
                    grid-template-columns: 2fr 1fr 1fr 1fr 80px;
                    gap: 15px;
                    align-items: center;
                    color: #1f2937;
                `;
                
                predictionCard.innerHTML = `
                    <div style="font-weight: 600;">${prediction.match}</div>
                    <div style="text-align: center;">
                        <strong>Pr√©dit:</strong><br>${prediction.predicted}
                    </div>
                    <div style="text-align: center;">
                        <strong>R√©el:</strong><br>${prediction.actual}
                    </div>
                    <div style="text-align: center;">
                        <span style="font-size: 0.9rem; color: #6b7280;">${prediction.confidence}%</span>
                    </div>
                    <div style="text-align: center; font-size: 1.5rem;">
                        ${correctIcon}
                    </div>
                `;
                
                container.appendChild(predictionCard);
            });
        }

        // Initialisation
        document.addEventListener('DOMContentLoaded', function() {
            // Pour le d√©ploiement, utiliser les donn√©es statiques
            updateStatsStatic();
        });
    </script>
</body>
</html>
